<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lead–Lag Design Lab (Browser App)</title>

  <!-- Local vendor bundles (no internet required) -->
  <script src="./vendor/plotly-2.30.0.min.js"></script>
  <script src="./vendor/numeric-1.2.6.min.js"></script>


  <style>
    * {
        box-sizing: border-box;
    }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; }
    .wrap { display: grid; grid-template-columns: 340px 1fr; gap: 12px; padding: 12px; }
    .panel { border: 1px solid #ddd; border-radius: 10px; padding: 12px; }
    .row { margin: 10px 0; }
    label { display: block; font-weight: 600; margin-bottom: 6px; }
    input[type="text"] { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box;}
    input[type="range"] { width: 100%; }
    .small { color: #555; font-size: 12px; }
    .value { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    .plot { border: 1px solid #ddd; border-radius: 10px; padding: 6px; }
    .title { font-size: 18px; font-weight: 800; margin: 0 0 10px; }
    button { padding: 10px 12px; border: 1px solid #ccc; border-radius: 10px; background: #fafafa; cursor: pointer; }
    button:hover { background: #f2f2f2; }
    .formula { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size: 13px; background:#fafafa; padding:8px; border-radius:8px; border:1px solid #eee;}

    /* ---- NEW LAYOUT ----
       Outer: 2 columns:
         - left: controls panel
         - right: plots area

       Plots area: 2 rows:
         - top row: bode + nyquist
         - bottom row: pole (narrow) + simulations (wide, y over u)
    */
    .plotsOuter {
      display: grid;
      grid-template-rows: auto auto;
      gap: 12px;
    }

    .topRow {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .bottomRow {
      display: grid;
      grid-template-columns: 0.6fr 1.4fr; /* pole narrower than simulations */
      gap: 12px;
      align-items: stretch;
    }

    .simStack {
      display: grid;
      grid-template-rows: 1fr 1fr; /* y on top of u */
      gap: 12px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="panel">
      <p class="title">Lead–Lag Design Lab</p>

      <div class="row">
        <label>Plant G(s): numerator coefficients</label>
        <input id="gNum" type="text" value="1" />
        <div class="small">Enter descending powers, e.g. <span class="value">1 5 6</span> means s²+5s+6</div>
      </div>

      <div class="row">
        <label>Plant G(s): denominator coefficients</label>
        <input id="gDen" type="text" value="1 3 2 0" />
        <div class="small">Default is 1/(s(s+1)(s+2)) → denom = <span class="value">[1 3 2 0]</span></div>
      </div>

      <div class="row">
        <div class="formula">
          C(s) = K * (s + a)/s * N * (s + b)/(s + bN)
        </div>
      </div>

      <div class="row">
        <label>K (log scale)</label>
        <input id="kSlider" type="range" min="-1" max="1" step="0.001" value="0">
        <div class="small">
          K =
          <input id="kInput" type="number" step="0.001" min="0.1" max="10" style="width:110px;">
          <span class="value" id="kVal"></span>
          (range 0.1 … 10)
        </div>
      </div>

      <div class="row">
        <label>a (log scale)</label>
        <input id="aSlider" type="range" min="-2" max="0" step="0.001" value="-2">
        <div class="small">
          a =
          <input id="aInput" type="number" step="0.001" min="0.01" max="1" style="width:110px;">
          <span class="value" id="aVal"></span>
          (range 0.01 … 1)
        </div>
      </div>

      <div class="row">
        <label>b (log scale)</label>
        <input id="bSlider" type="range" min="-1" max="1" step="0.001" value="0">
        <div class="small">
          b =
          <input id="bInput" type="number" step="0.001" min="0.1" max="10" style="width:110px;">
          <span class="value" id="bVal"></span>
          (range 0.1 … 10)
        </div>
      </div>

      <div class="row">
        <label>N (log scale)</label>
        <input id="nSlider" type="range" min="0" max="1.30103" step="0.001" value="0.30103">
        <div class="small">
          N =
          <input id="nInput" type="number" step="0.01" min="1" max="20" style="width:110px;">
          <span class="value" id="nVal"></span>
          (range 1 … 20)
        </div>
      </div>

      <div class="row" style="display:flex; gap:10px; align-items:center;">
        <button id="reseedBtn">Reseed noise</button>
        <button id="resetBtn">Reset defaults</button>
      </div>

      <div class="small">
        Experiment signals: step reference, load disturbance at t=20s, measurement noise at t=40s.
      </div>
    </div>

    <!-- PLOTS -->
    <div class="plotsOuter">
      <!-- Top row: Bode + Nyquist -->
      <div class="topRow">
        <div class="plot">
          <div id="bodePlot" style="height:540px;"></div>
        </div>
        <div class="plot">
          <div id="nyquistPlot" style="height:540px;"></div>
        </div>
      </div>

      <!-- Bottom row: Pole (narrow) + Simulations (wide, stacked) -->
      <div class="bottomRow">
        <div class="plot">
          <div id="polePlot" style="height:520px;"></div>
        </div>

        <div class="simStack">
          <div class="plot">
            <div id="yPlot" style="height:250px;"></div>
          </div>
          <div class="plot">
            <div id="uPlot" style="height:250px;"></div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script src="./app.js"></script>
</body>
</html>

